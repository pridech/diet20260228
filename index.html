<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2025餐厅评价年度报告</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        body {
            font-family: "WPS灵秀黑", "微软雅黑", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            overflow: hidden;
            background: #000;
        }
        #playOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: #333333;
            font-size: 1.6em;
            text-align: center;
            pointer-events: auto;
        }
        .page-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }
        section {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            opacity: 0;
            transition: opacity 0.8s ease;
            z-index: 0;
            color: #333333;
            text-shadow: 0 1px 2px rgba(255,255,255,0.2);
            padding-top: 60px;
        }
        section.active {
            opacity: 1;
            z-index: 10;
        }
        .video-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .video-bg.played {
            opacity: 1;
        }
        .page-content {
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
        }
        ::-webkit-scrollbar {
            width: 4px;
            height: 4px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(51,51,51,0.3);
            border-radius: 10px;
        }
        .text-large { font-size: 3.2em; font-weight: 700; line-height: 1.4; }
        .text-medium-large { font-size: 2.2em; font-weight: 600; text-align: center; white-space: nowrap; }
        .text-medium { font-size: 1.8em; font-weight: 500; text-align: center; }
        .text-small { font-size: 1.4em; font-weight: 400; text-align: center; }
        .text-tiny { font-size: 0.9em; font-weight: 300; text-align: center; }
        .page1 .page-content {
            justify-content: center;
            align-items: center;
            height: 100%;
            padding-top: 80px;
        }
        .page1 .title {
            margin-bottom: 30px;
            opacity: 0;
            animation: fadeIn 0.7s ease 0.3s forwards;
            text-align: center;
        }
        .page1 .subtitle {
            opacity: 0;
            animation: fadeIn 0.7s ease 0.5s forwards;
            text-align: center;
        }
        .page2 .stats, .page3 .comparison, .page4 .scores {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }
        .chart-page .page-content {
            align-items: center;
            gap: 20px;
            margin-top: 20px;
        }
        .chart-container {
            width: 100%;
            height: 380px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            margin-top: 10px;
        }
        .ranking-page .page-content {
            align-items: center;
            gap: 20px;
        }
        .ranking-list {
            width: 100%;
            max-height: 70vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            margin-top: 10px;
        }
        .ranking-item {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 15px 20px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: transform 0.3s ease;
            width: 100%;
        }
        .ranking-item.parallax { will-change: transform; }
        .ranking-item .rank {
            font-family: "思源黑体", sans-serif;
            font-size: 1.8em;
            font-weight: 700;
            width: 40px;
            text-align: center;
            flex-shrink: 0;
        }
        .rank-1 { color: #FFD700; }
        .rank-2 { color: #C0C0C0; }
        .rank-3 { color: #CD7F32; }
        .ranking-item .info {
            flex: 1;
            margin-left: 15px;
            overflow: hidden;
        }
        .ranking-item .name {
            font-size: 1.3em;
            font-weight: 500;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
            line-height: 1.4;
        }
        .ranking-item .score {
            font-family: "思源黑体", sans-serif;
            font-size: 1.1em;
            color: #444444;
            text-align: right;
            flex-shrink: 0;
            width: 120px;
        }
        .card-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            width: 85%;
            max-width: 400px;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            color: #333333;
        }
        .card-popup.active {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            pointer-events: auto;
        }
        .card-popup .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5em;
            cursor: pointer;
            color: #333333;
        }
        .card-popup .content {
            line-height: 2;
            font-size: 1.2em;
        }
        .page12 .page-content {
            justify-content: center;
            align-items: center;
            height: 100%;
            padding-top: 100px;
        }
        .page12 .line {
            opacity: 0;
            animation: fadeInUp 0.8s ease forwards;
            margin: 10px 0;
        }
        .page12 .line-1 { animation-delay: 0.5s; }
        .page12 .line-2 { animation-delay: 1.0s; }
        .page12 .line-3 { animation-delay: 1.5s; }
        .page12 .line-4 { animation-delay: 2.0s; }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="playOverlay">点击任意位置开始播放</div>
    <div class="page-container">
        <!-- P1 封面 -->
        <section class="page1 active">
            <video class="video-bg" id="video1" loop muted playsinline>
                <source src="https://pridech.github.io/diet20260228/v0369cg10004d6beab7og65pefsj2bmg.mp4" type="video/mp4">
            </video>
            <div class="page-content">
                <div class="title text-large">2025 餐厅评价<br>年度报告</div>
                <div class="subtitle text-small">小琪小辞编</div>
            </div>
        </section>

        <!-- P2 总览数据 -->
        <section class="page2">
            <video class="video-bg" id="video2" loop muted playsinline>
                <source src="https://pridech.github.io/diet20260228/video2.mp4" type="video/mp4">
            </video>
            <div class="page-content">
                <div class="year text-large">2025</div>
                <div class="stats">
                    <div class="text-medium">评价餐厅数量 160</div>
                    <div class="text-medium">平均价格 114.9</div>
                    <div class="text-medium">平均评分 6.22</div>
                </div>
            </div>
        </section>

        <!-- P3 消费类型对比 -->
        <section class="page3">
            <video class="video-bg" id="video3" loop muted playsinline>
                <source src="https://pridech.github.io/diet20260228/video3.mp4" type="video/mp4">
            </video>
            <div class="page-content">
                <div class="year text-large">2025</div>
                <div class="comparison">
                    <div class="text-medium">消费餐厅 108 家</div>
                    <div class="text-small">占比67.5% 均价 109.8・均分 6.43</div>
                    <div class="text-medium">免费餐厅 52 家</div>
                    <div class="text-small">占比32.5% 均价 125.6・均分 5.79</div>
                </div>
            </div>
        </section>

        <!-- P4 两人评分对比 -->
        <section class="page4">
            <video class="video-bg" id="video4" loop muted playsinline>
                <source src="https://pridech.github.io/diet20260228/video4.mp4" type="video/mp4">
            </video>
            <div class="page-content">
                <div class="year text-large">2025</div>
                <div class="scores">
                    <div class="text-medium">小琪 平均评分 6.15</div>
                    <div class="text-medium">小辞 平均评分 6.34</div>
                </div>
            </div>
        </section>

        <!-- P5 四维度分析 -->
        <section class="page5 chart-page">
            <video class="video-bg" id="video5" loop muted playsinline>
                <source src="https://pridech.github.io/diet20260228/video5.mp4" type="video/mp4">
            </video>
            <div class="page-content">
                <div class="chart-title text-medium">小琪小辞四维度评价对比</div>
                <div id="chart21" class="chart-container"></div>
            </div>
        </section>

        <!-- P6 评分分布 -->
        <section class="page6 chart-page">
            <video class="video-bg" id="video5" loop muted playsinline>
                <source src="https://pridech.github.io/diet20260228/video5.mp4" type="video/mp4">
            </video>
            <div class="page-content">
                <div class="chart-title text-medium">餐厅评分分布情况</div>
                <div id="chart22" class="chart-container"></div>
            </div>
        </section>

        <!-- P7 TOP15 餐厅排行榜 -->
        <section class="page7 ranking-page">
            <video class="video-bg" id="video6" loop muted playsinline>
                <source src="https://pridech.github.io/diet20260228/video6.mp4" type="video/mp4">
            </video>
            <div class="page-content">
                <div class="ranking-title text-medium-large">2025 年 TOP15 餐厅排行榜</div>
                <div class="ranking-list">
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.1s both;"><span class="rank rank-1">1</span><div class="info"><div class="name">前海沿 青岛菜</div></div><div class="score">8.48 · 236</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.2s both;"><span class="rank rank-2">2</span><div class="info"><div class="name">青叶食堂</div></div><div class="score">7.83 · 138</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.3s both;"><span class="rank rank-3">3</span><div class="info"><div class="name">南昌米粉</div></div><div class="score">7.76 · 18</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.4s both;"><span class="rank">4</span><div class="info"><div class="name">大吉利潮汕牛肉火锅</div></div><div class="score">7.73 · 120</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.5s both;"><span class="rank">5</span><div class="info"><div class="name">群乐饭店</div></div><div class="score">7.70 · 115</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.6s both;"><span class="rank">6</span><div class="info"><div class="name">金家馅饼</div></div><div class="score">7.69 · 70</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.7s both;"><span class="rank">7</span><div class="info"><div class="name">香园茶社</div></div><div class="score">7.66 · 118</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.8s both;"><span class="rank">8</span><div class="info"><div class="name">喜鼎</div></div><div class="score">7.65 · 304</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.9s both;"><span class="rank">9</span><div class="info"><div class="name">船歌鱼水饺</div></div><div class="score">7.60 · 168</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 1.0s both;"><span class="rank">10</span><div class="info"><div class="name">西镇臭豆腐</div></div><div class="score">7.55 · 28</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 1.1s both;"><span class="rank">11</span><div class="info"><div class="name">老青岛排骨米饭</div></div><div class="score">7.50 · 45</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 1.2s both;"><span class="rank">12</span><div class="info"><div class="name">九龙餐厅</div></div><div class="score">7.45 · 88</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 1.3s both;"><span class="rank">13</span><div class="info"><div class="name">甜沫儿早餐</div></div><div class="score">7.40 · 32</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 1.4s both;"><span class="rank">14</span><div class="info"><div class="name">野馄饨烧烤摊</div></div><div class="score">7.35 · 66</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 1.5s both;"><span class="rank">15</span><div class="info"><div class="name">李村脂渣店</div></div><div class="score">7.30 · 58</div></div>
                </div>
            </div>
        </section>

        <!-- P8 BOT15 餐厅倒数榜 -->
        <section class="page8 ranking-page">
            <video class="video-bg" id="video6" loop muted playsinline>
                <source src="https://pridech.github.io/diet20260228/video6.mp4" type="video/mp4">
            </video>
            <div class="page-content">
                <div class="ranking-title text-medium-large">2025 年 BOT15 餐厅排行榜</div>
                <div class="ranking-list">
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.1s both;"><span class="rank rank-1">1</span><div class="info"><div class="name">某网红海鲜大排档</div></div><div class="score">3.00 · 298</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.2s both;"><span class="rank rank-2">2</span><div class="info"><div class="name">景区连锁炸酱面</div></div><div class="score">3.50 · 68</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.3s both;"><span class="rank rank-3">3</span><div class="info"><div class="name">高端自助铁板烧</div></div><div class="score">4.00 · 368</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.4s both;"><span class="rank">4</span><div class="info"><div class="name">网红奶茶火锅</div></div><div class="score">4.20 · 128</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.5s both;"><span class="rank">5</span><div class="info"><div class="name">速冻水饺专营店</div></div><div class="score">4.30 · 25</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.6s both;"><span class="rank">6</span><div class="info"><div class="name">速食汉堡简餐店</div></div><div class="score">4.40 · 35</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.7s both;"><span class="rank">7</span><div class="info"><div class="name">预制菜中餐厅</div></div><div class="score">4.50 · 89</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.8s both;"><span class="rank">8</span><div class="info"><div class="name">网红脆皮五花肉</div></div><div class="score">4.60 · 45</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 0.9s both;"><span class="rank">9</span><div class="info"><div class="name">景区特产伴手礼店</div></div><div class="score">4.70 · 158</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 1.0s both;"><span class="rank">10</span><div class="info"><div class="name">自助旋转小火锅</div></div><div class="score">4.80 · 58</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 1.1s both;"><span class="rank">11</span><div class="info"><div class="name">速溶咖啡简餐吧</div></div><div class="score">4.90 · 32</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 1.2s both;"><span class="rank">12</span><div class="info"><div class="name">冷冻海鲜加工店</div></div><div class="score">5.00 · 188</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 1.3s both;"><span class="rank">13</span><div class="info"><div class="name">网红芝士焗饭</div></div><div class="score">5.10 · 66</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 1.4s both;"><span class="rank">14</span><div class="info"><div class="name">半成品披萨店</div></div><div class="score">5.20 · 42</div></div>
                    <div class="ranking-item parallax" style="animation: fadeInUp 0.5s ease 1.5s both;"><span class="rank">15</span><div class="info"><div class="name">速食关东煮小店</div></div><div class="score">5.30 · 22</div></div>
                </div>
            </div>
        </section>

        <!-- P9 性价比 TOP10 -->
        <section class="page9 ranking-page">
            <video class="video-bg" id="video6" loop muted playsinline>
                <source src="https://pridech.github.io/diet20260228/video6.mp4" type="video/mp4">
            </video>
            <div class="page-content">
                <div class="ranking-title text-medium-large">2025 年性价比 TOP10 餐厅</div>
                <div class="ranking-list">
                    <div class="ranking-item" data-details="餐厅名称：南昌米粉&#10;总分合计：7.76&#10;消费价格：18元&#10;性价比得分：0.431"><span class="rank rank-1">1</span><div class="info"><div class="name">南昌米粉</div></div><div class="score">7.76 · 18</div></div>
                    <div class="ranking-item" data-details="餐厅名称：西镇臭豆腐&#10;总分合计：7.55&#10;消费价格：28元&#10;性价比得分：0.269"><span class="rank rank-2">2</span><div class="info"><div class="name">西镇臭豆腐</div></div><div class="score">7.55 · 28</div></div>
                    <div class="ranking-item" data-details="餐厅名称：甜沫儿早餐&#10;总分合计：7.40&#10;消费价格：32元&#10;性价比得分：0.231"><span class="rank rank-3">3</span><div class="info"><div class="name">甜沫儿早餐</div></div><div class="score">7.40 · 32</div></div>
                    <div class="ranking-item" data-details="餐厅名称：老青岛排骨米饭&#10;总分合计：7.50&#10;消费价格：45元&#10;性价比得分：0.167"><span class="rank">4</span><div class="info"><div class="name">老青岛排骨米饭</div></div><div class="score">7.50 · 45</div></div>
                    <div class="ranking-item" data-details="餐厅名称：金家馅饼&#10;总分合计：7.69&#10;消费价格：70元&#10;性价比得分：0.110"><span class="rank">5</span><div class="info"><div class="name">金家馅饼</div></div><div class="score">7.69 · 70</div></div>
                    <div class="ranking-item" data-details="餐厅名称：野馄饨烧烤摊&#10;总分合计：7.35&#10;消费价格：66元&#10;性价比得分：0.111"><span class="rank">6</span><div class="info"><div class="name">野馄饨烧烤摊</div></div><div class="score">7.35 · 66</div></div>
                    <div class="ranking-item" data-details="餐厅名称：李村脂渣店&#10;总分合计：7.30&#10;消费价格：58元&#10;性价比得分：0.126"><span class="rank">7</span><div class="info"><div class="name">李村脂渣店</div></div><div class="score">7.30 · 58</div></div>
                    <div class="ranking-item" data-details="餐厅名称：九龙餐厅&#10;总分合计：7.45&#10;消费价格：88元&#10;性价比得分：0.085"><span class="rank">8</span><div class="info"><div class="name">九龙餐厅</div></div><div class="score">7.45 · 88</div></div>
                    <div class="ranking-item" data-details="餐厅名称：青叶食堂&#10;总分合计：7.83&#10;消费价格：138元&#10;性价比得分：0.057"><span class="rank">9</span><div class="info"><div class="name">青叶食堂</div></div><div class="score">7.83 · 138</div></div>
                    <div class="ranking-item" data-details="餐厅名称：群乐饭店&#10;总分合计：7.70&#10;消费价格：115元&#10;性价比得分：0.067"><span class="rank">10</span><div class="info"><div class="name">群乐饭店</div></div><div class="score">7.70 · 115</div></div>
                </div>
            </div>
        </section>

        <!-- P10 月度消费趋势 -->
        <section class="page10 chart-page">
            <video class="video-bg" id="video5" loop muted playsinline>
                <source src="https://pridech.github.io/diet20260228/video5.mp4" type="video/mp4">
            </video>
            <div class="page-content">
                <div class="chart-title text-medium">小琪小辞・月度消费趋势</div>
                <div id="chart23" class="chart-container"></div>
            </div>
        </section>

        <!-- P11 评分 × 消费类型交叉分析 -->
        <section class="page11 chart-page">
            <video class="video-bg" id="video5" loop muted playsinline>
                <source src="https://pridech.github.io/diet20260228/video5.mp4" type="video/mp4">
            </video>
            <div class="page-content">
                <div class="chart-title text-medium">评分 × 消费交叉分析</div>
                <div id="chart24" class="chart-container"></div>
            </div>
        </section>

        <!-- P12 封底 -->
        <section class="page12">
            <video class="video-bg" id="video1" loop muted playsinline>
                <source src="https://pridech.github.io/diet20260228/v0369cg10004d6beab7og65pefsj2bmg.mp4" type="video/mp4">
            </video>
            <div class="page-content">
                <div class="line line-1 text-medium-large">幸福就是</div>
                <div class="line line-2 text-medium-large">在一起</div>
                <div class="line line-3 text-medium-large">吃很多很多很多顿饭</div>
                <div class="line line-4 text-medium-large">永远</div>
            </div>
        </section>
    </div>

    <div class="card-popup" id="cardPopup">
        <div class="close-btn" id="closeCard">×</div>
        <div class="content" id="cardContent"></div>
    </div>

    <script>
        // 点击播放
        const playOverlay = document.getElementById('playOverlay');
        const allVideos = document.querySelectorAll('.video-bg');
        playOverlay.addEventListener('click', function() {
            playOverlay.style.display = 'none';
            allVideos.forEach(video => {
                video.play().then(() => {
                    video.classList.add('played');
                }).catch(e => {
                    video.classList.add('played');
                });
            });
        });

        // 翻页核心
        let currentPage = 0;
        const pages = document.querySelectorAll('section');
        const totalPages = pages.length;
        let isScrolling = false;
        let touchStartY = 0;
        let touchMoveY = 0;

        // 阻止滚动冒泡+判断滚动状态
        document.querySelectorAll('.page-content, .ranking-list').forEach(el => {
            el.addEventListener('touchmove', (e) => {
                e.stopPropagation();
                isScrolling = true;
                clearTimeout(window.scrollEndTimer);
                window.scrollEndTimer = setTimeout(() => {
                    isScrolling = false;
                }, 200);
            }, { passive: true });
        });

        // 滑动翻页-精准判断
        document.addEventListener('touchstart', (e) => {
            if (isScrolling) return;
            touchStartY = e.touches[0].clientY;
        });
        document.addEventListener('touchmove', (e) => {
            if (isScrolling) return;
            touchMoveY = e.touches[0].clientY;
        });
        document.addEventListener('touchend', (e) => {
            if (isScrolling) return;
            const touchEndY = e.changedTouches[0].clientY;
            const deltaY = touchStartY - touchEndY;
            if (deltaY > 80 && currentPage < totalPages - 1) {
                pages[currentPage].classList.remove('active');
                currentPage++;
                pages[currentPage].classList.add('active');
                initParallax();
            } else if (deltaY < -80 && currentPage > 0) {
                pages[currentPage].classList.remove('active');
                currentPage--;
                pages[currentPage].classList.add('active');
                initParallax();
            }
        });

        // 视差效果
        function initParallax() {
            const currentRankingPage = pages[currentPage];
            const parallaxItems = currentRankingPage.querySelectorAll('.parallax');
            if (parallaxItems.length === 0) return;
            const rankingList = currentRankingPage.querySelector('.ranking-list');
            let lastScrollTop = 0;
            rankingList.addEventListener('scroll', () => {
                const scrollTop = rankingList.scrollTop;
                const direction = scrollTop > lastScrollTop ? 1 : -1;
                lastScrollTop = scrollTop;
                parallaxItems.forEach((item, index) => {
                    const offset = (index * 3 + scrollTop * 0.03) * direction;
                    item.style.transform = `translateY(${offset}px)`;
                });
            });
        }

        // 性价比弹窗
        const cardPopup = document.getElementById('cardPopup');
        const cardContent = document.getElementById('cardContent');
        const closeCard = document.getElementById('closeCard');
        document.querySelectorAll('.page9 .ranking-item').forEach(item => {
            item.addEventListener('click', (e) => {
                e.stopPropagation();
                const details = item.getAttribute('data-details');
                cardContent.innerHTML = details.replace(/&#10;/g, '<br>');
                cardPopup.classList.add('active');
            });
        });
        closeCard.addEventListener('click', () => cardPopup.classList.remove('active'));
        cardPopup.addEventListener('click', (e) => {
            if (e.target === cardPopup) cardPopup.classList.remove('active');
        });

        // ECharts 初始化-深灰色系
        // P5 四维度
        const chart21 = echarts.init(document.getElementById('chart21'));
        const option21 = {
            backgroundColor: 'transparent',
            textStyle: { color: '#333333' },
            xAxis: {
                type: 'category',
                data: ["菜品", "环境", "服务", "性价比"],
                name: "评分维度",
                nameLocation: "middle",
                nameGap: 25,
                nameTextStyle: { color: "#333333", fontSize: 12 },
                axisLine: { lineStyle: { color: '#333333' } },
                axisLabel: { color: '#333333', fontSize: 12 },
                splitLine: { show: false }
            },
            yAxis: {
                type: 'value',
                name: "平均分",
                nameLocation: "middle",
                nameGap: 40,
                min: 5.0,
                max: 6.6,
                interval: 0.2,
                nameTextStyle: { color: "#333333", fontSize: 12 },
                axisLine: { lineStyle: { color: '#333333' } },
                axisLabel: { color: '#333333', fontSize: 11, formatter: "{value}" },
                splitLine: { lineStyle: { color: 'rgba(51,51,51,0.2)', type: "dashed" } }
            },
            series: [
                { name: '小琪', type: 'bar', data: [6.33, 5.87, 5.78, 5.51], itemStyle: { color: 'rgba(74, 120, 194, 0.8)', borderColor: "#3A5F98", borderWidth: 2 }, barGap: '20%' },
                { name: '小辞', type: 'bar', data: [6.51, 6.14, 6.06, 5.70], itemStyle: { color: 'rgba(141, 211, 95, 0.8)', borderColor: "#75B84D", borderWidth: 2 } },
                { name: '整体', type: 'bar', data: [6.42, 6.01, 5.92, 5.61], itemStyle: { color: 'rgba(240, 184, 110, 0.8)', borderColor: "#E09F4B", borderWidth: 2 } }
            ],
            legend: { data: ['小琪', '小辞', '整体'], left: "center", top: "10px", orient: "horizontal", itemGap: 20, textStyle: { color: '#333333', fontSize: 12 } },
            tooltip: { trigger: 'axis', backgroundColor: 'rgba(255,255,255,0.9)', textStyle: { color: '#333333', fontSize: 11 }, formatter: "{b}<br/>{a}：{c}" },
            dataZoom: [{ type: "inside", rangeStart: 0, rangeEnd: 100 }],
            toolbox: { show: true, left: "center", top: "50px", itemSize: 16, feature: { saveAsImage: {}, magicType: { type: ["line", "bar"] } }, iconStyle: { color: '#333333' } }
        };
        chart21.setOption(option21);

        // P6 评分分布-修复文字显示
        const chart22 = echarts.init(document.getElementById('chart22'));
        const option22 = {
            backgroundColor: 'transparent',
            textStyle: { color: '#333333' },
            tooltip: { trigger: 'item', backgroundColor: 'rgba(255,255,255,0.9)', textStyle: { color: '#333333', fontSize: 11 } },
            legend: { data: ['5分以下', '5-6分', '6-7分', '7分以上'], textStyle: { color: '#333333', fontSize: 12 }, left: 'center', top: '10px' },
            series: [{
                type: 'pie',
                radius: ['30%', '70%'],
                center: ['50%', '60%'],
                data: [
                    { value: 15, name: '5分以下' },
                    { value: 35, name: '5-6分' },
                    { value: 40, name: '6-7分' },
                    { value: 10, name: '7分以上' }
                ],
                itemStyle: { color: (p) => ['#F06292', '#FFB74D', '#81C784', '#64B5F6'][p.dataIndex] },
                label: { color: '#333333', fontSize: 11, formatter: '{b}: {c}家\n({d}%)' },
                labelLine: { show: false },
                avoidLabelOverlap: true
            }]
        };
        chart22.setOption(option22);

        // P10 月度消费趋势
        const chart23 = echarts.init(document.getElementById('chart23'));
        const option23 = {
            backgroundColor: 'transparent',
            textStyle: { color: '#333333' },
            tooltip: { trigger: 'axis', backgroundColor: 'rgba(255,255,255,0.9)', textStyle: { color: '#333333', fontSize: 11 } },
            legend: { data: ['平均价格(元)', '评价餐厅数', '平均总分'], left: "center", top: "10px", textStyle: { color: '#333333', fontSize: 11 } },
            xAxis: { type: 'category', data: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'], axisLine: { lineStyle: { color: '#333333' } }, axisLabel: { color: '#333333', fontSize: 10 }, splitLine: { show: false } },
            yAxis: [
                { type: 'value', name: '分数/餐厅数', min: 0, max: 30, interval: 5, nameTextStyle: { color: '#333333', fontSize: 12 }, axisLine: { lineStyle: { color: '#333333' } }, axisLabel: { color: '#333333', fontSize: 11 }, splitLine: { lineStyle: { color: 'rgba(51,51,51,0.2)', type: "dashed" } } },
                { type: 'value', name: '价格(元)', min: 80, max: 150, interval: 10, nameTextStyle: { color: '#333333', fontSize: 12 }, axisLine: { lineStyle: { color: '#333333' } }, axisLabel: { color: '#333333', fontSize: 11 }, splitLine: { show: false } }
            ],
            series: [
                { name: '平均价格(元)', type: 'line', data: [90.44, 128.59, 112.65, 131.97, 126.62, 134.02, 150, 142, 84.02, 103.07, 101.13, 110.62], yAxisIndex: 1, itemStyle: { color: "#F06292" }, lineStyle: { width: 3 }, symbolSize: 8 },
                { name: '评价餐厅数', type: 'line', data: [9, 9, 11, 17, 13, 9, 10, 12, 12, 15, 15, 24], yAxisIndex: 0, itemStyle: { color: "#81C784" }, lineStyle: { width: 3 }, symbolSize: 8 },
                { name: '平均总分', type: 'line', data: [6.73, 6.34, 5.96, 6.41, 5.91, 6.09, 5.97, 6.06, 6.22, 6.21, 6.35, 6.39], yAxisIndex: 0, itemStyle: { color: "#64B5F6" }, lineStyle: { width: 3 }, symbolSize: 8 }
            ],
            dataZoom: [{ type: "inside", rangeStart: 0, rangeEnd: 100 }]
        };
        chart23.setOption(option23);

        // P11 交叉分析
        const chart24 = echarts.init(document.getElementById('chart24'));
        const option24 = {
            backgroundColor: 'transparent',
            textStyle: { color: '#333333' },
            tooltip: { trigger: 'axis', backgroundColor: 'rgba(255,255,255,0.9)', textStyle: { color: '#333333', fontSize: 11 } },
            legend: { data: ['消费餐厅', '免费餐厅'], left: "center", top: "10px", textStyle: { color: '#333333', fontSize: 12 } },
            xAxis: { type: 'category', data: ['5分以下', '5-6分', '6-7分', '7分以上'], axisLine: { lineStyle: { color: '#333333' } }, axisLabel: { color: '#333333', fontSize: 12 } },
            yAxis: { type: 'value', name: '餐厅数量', nameTextStyle: { color: '#333333', fontSize: 12 }, axisLine: { lineStyle: { color: '#333333' } }, axisLabel: { color: '#333333', fontSize: 11 }, splitLine: { lineStyle: { color: 'rgba(51,51,51,0.2)', type: "dashed" } } },
            series: [
                { name: '消费餐厅', type: 'bar', data: [5, 20, 75, 8], itemStyle: { color: 'rgba(74, 120, 194, 0.8)' }, barGap: '20%' },
                { name: '免费餐厅', type: 'bar', data: [10, 15, 25, 2], itemStyle: { color: 'rgba(141, 211, 95, 0.8)' } }
            ]
        };
        chart24.setOption(option24);

        // 响应式
        window.addEventListener('resize', () => {
            chart21.resize();
            chart22.resize();
            chart23.resize();
            chart24.resize();
        });
    </script>
</body>
</html>
